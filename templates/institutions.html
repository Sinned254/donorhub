<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charity Connect - Institutions</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Charity Connect</h1>
        <p>Connecting angels with charitable institutions</p>
    </header>

    <nav>
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('institutions') }}">Institutions</a>
        <a href="{{ url_for('about') }}">About</a>
    </nav>

    <div class="container">
        <!-- Flash messages block -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <ul class="flashes">
                {% for category, message in messages %}
                    <li class="{{ category }}">{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        {% endwith %}
        <div id="institutions-list">
            <h2>Registered Institutions</h2>
            <p>See what our community of <strong>angels</strong> can support today!</p>
            {% if institutions %}
                {% for institution in institutions %}
                    <div class="institution-profile">
                        <div class="institution-details">
                            <h3>{{ institution.name }}</h3>
                            <p><strong>Location:</strong> {{ institution.location }}</p>
                            <p><strong>Contact Email:</strong> {{ institution.email }}</p>
                            <p><strong>Contact Phone:</strong> {{ institution.phone }}</p>
                            {% if institution.website %}
                                <p><strong>Website:</strong> <a href="{{ institution.website }}" target="_blank">{{ institution.website }}</a></p>
                            {% endif %}
                            <p><strong>Type:</strong> {{ institution.type }}</p>
                            {% if institution.photo_filename %}
                                <img src="{{ url_for('static', filename='uploads/' + institution.photo_filename) }}" alt="{{ institution.name }} Photo" width="150">
                            {% else %}
                                <img src="{{ url_for('static', filename='images/default_institution.png') }}" alt="Default Photo" width="150">
                            {% endif %}
                        </div>
                        <div class="needed-items-list">
                            <p><strong>Needed Items:</strong></p>
                            <ul>
                                {% if institution.needed_items %}
                                    {% for item in institution.needed_items %}
                                        <li>{{ item }}</li>
                                    {% endfor %}
                                {% else %}
                                    <li>No specific items listed.</li>
                                {% endif %}
                            </ul>
                            <a href="{{ url_for('donate', institution_id=institution.id) }}" class="button">Donate</a>
                        </div>
                    </div>
                    <hr>
                {% endfor %}
            {% else %}
                <p>No institutions registered yet.</p>
            {% endif %}
        </div>
        <div style="text-align:center; margin: 2em 0;">
            <a href="{{ url_for('login') }}" class="button" style="font-size:1.2em;">Register Your Institution</a>
        </div>
    </div>

    <footer>
        &copy; 2023 Charity Connect
    </footer>
</body>
</html>